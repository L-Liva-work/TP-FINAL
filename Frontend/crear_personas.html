<!DOCTYPE html>
<html>
    <head>
        <title>Proyecto</title>
        <link
          rel="stylesheet"
          href="https://cdn.jsdelivr.net/npm/bulma@1.0.2/css/bulma.min.css"
        >
        <script src="https://kit.fontawesome.com/d1c58f18fd.js" crossorigin="anonymous"></script>

    </head>
    <body>
      <div class="container is-fluid">
        <nav class="navbar" role="navigation" aria-label="main navigation">
        <div class="navbar-brand">
          <a class="navbar-item" href="users.html"><strong>JLF</strong></a>
      
          <a role="button" class="navbar-burger" aria-label="menu" aria-expanded="false" data-target="navbarBasicExample">
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
            <span aria-hidden="true"></span>
          </a>
        </div>
      
        <div id="navbarBasicExample" class="navbar-menu">
          <div class="navbar-start">
            <a class="navbar-item">
              Inicio
            </a>
      
            <a class="navbar-item">
              Mis proyectos
            </a>
      
            <div class="navbar-item has-dropdown is-hoverable">
              <a class="navbar-link">
                Usuarios
              </a>
      
              <div class="navbar-dropdown">
                <a class="navbar-item">
                  Detalles
                </a>
                <a class="navbar-item is-selected" href="persons.html">
                  Integrantes del grupo
                </a>
                
              </div>
            </div>
          </div>
      
          <div class="navbar-end">
            <div class="navbar-item">
              <div class="buttons">
                <a class="button is-primary" href="create_persons.html">
                  <strong>Agregar usuario </strong>
                  <span class="icon is-small is-left">
                    <i class="fa-solid fa-user-plus"></i>
                  </span>
                </a>
                <a class="button is-light">
                  <i class="fa-solid fa-user-plus"></i>
                </a>
              </div>
            </div>
          </div>
        </div>
        </nav>

        <h1>Formulario:</h1>
        <div class="container is-max-widescreen">
          <form>
          <div class="field">
            <label class="label">Nombre</label>
            <div class="control has-icons-left has-icons-right">
              <input id="nombre" class="input" type="text" placeholder="Ingrese su nombre">
              <span class="icon is-small is-left">
                <i class="fa-solid fa-user"></i>
              </span>
            </div>
          </div>        
          
          <div class="field">
            <label class="label">Email</label>
            <div class="control has-icons-left has-icons-right">
              <input id="email" class="input " type="email" placeholder="Email">
              <span class="icon is-small is-left">
                <i class="fas fa-envelope"></i>
            </div>
          </div>
 
          <div class="field">
            <label class="label">Documento</label>
            <div class="control has-icons-left has-icons-right">
              <input id="documento" class="input" type="text" placeholder="documento">
              <span class="icon is-small is-left">
                <i class="fa-solid fa-id-card"></i>
              </span>
            </div>
          </div>

          <div class="field">
            <label class="label">Puesto</label>
            <div class="control has-icons-left has-icons-right">
              <input id="puesto" class="input" type="text" placeholder="Ingrese el puesto que ocupa">
              <span class="icon is-small is-left">
                <i class="fa-solid fa-briefcase"></i>
              </span>
            </div>
          </div>
                          
          
          <div class="field is-grouped is-grouped-centered">
            <div class="control">
              <button class="button is-link" onclick="create_person()">Crear</button>
            </div>
            <div class="control">
              <button class="button is-link is-light"><a href="persons.html">Cancelar</a></button>
            </div>
          </div>
        </form>
        </div> 
        
      </div>

    </body>

    <footer>
    </footer>

    <script>
      function create_person() {
        event.preventDefault()
        const nombre = document.getElementById('nombre').value 
        const email = document.getElementById('email').value 
        const doc = document.getElementById('documento').value 
        const puesto = document.getElementById('puesto').value 

        let body =  {
            email: email,
            nombre: nombre,
            doc: parseInt(doc),
            puesto: puesto
        }

        fetch('http://localhost:3000/api/v1/persons', {
          method: 'POST',
          headers: {
            'Content-Type': 'application/json'
          },
          body: JSON.stringify(body)
        })
        .then(response =>{
          console.log(response.status)
          if (response.status === 201) {
              alert('Persona creada con exito') 
              limpiar_formulario()   
          } else {
            alert('Error al crear un persona')
          }
        })

      }

      function limpiar_formulario() {
        document.getElementById('nombre').value  = '' 
        document.getElementById('email').value = '' 
        document.getElementById('documento').value = ''
        document.getElementById('puesto').value= '' 
      }
    </script>
</html>
